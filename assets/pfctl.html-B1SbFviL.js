import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as a,c as n,b as t}from"./app-CHACLx4z.js";const s={},l=t(`<h1 id="pfctl" tabindex="-1"><a class="header-anchor" href="#pfctl"><span>pfctl</span></a></h1><p>PF防火墙的配置命令</p><h2 id="补充说明" tabindex="-1"><a class="header-anchor" href="#补充说明"><span>补充说明</span></a></h2><p><strong>pfctl命令</strong> 是PF防火墙的配置命令，PF防火墙( 全称：Packet Filter )是UNIX LIKE系统上进行TCP/ip流量过滤和网络地址转换的软件系统。PF同样也能提供TCP/IP流量的整形和控制，并且提供带宽控制和数据包优先集控制。PF最早是由Daniel Hartmeier开发的，现在的开发和维护由Daniel和openBSD小组的其他成员负责。</p><p>PF防火墙的功能很多，本站只列举一些基本配置。</p><h3 id="激活" tabindex="-1"><a class="header-anchor" href="#激活"><span>激活</span></a></h3><p>要激活pf并且使它在启动时调用配置文件，编辑<code>/etc/rc.conf</code>文件，修改配置pf的一行：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token assign-left variable">pf</span><span class="token operator">=</span>yes
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>重启操作系统让配置生效。</p><p>也可以通过pfctl程序启动和停止pf：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>pfctl <span class="token parameter variable">-e</span>
pfctl <span class="token parameter variable">-d</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>注意这仅仅是启动和关闭PF，实际它不会载入规则集，规则集要么在系统启动时载入，要在PF启动后通过命令单独载入。</p><h3 id="配置" tabindex="-1"><a class="header-anchor" href="#配置"><span>配置</span></a></h3><p>系统引导到在rc脚本文件运行PF时PF从<code>/etc/pf.conf</code>文件载入配置规则。注意当<code>/etc/pf.conf</code>文件是默认配置文件，在系统调用rc脚本文件时，它仅仅是作为文本文件由pfctl装入并解释和插入pf的。对于一些应用来说，其他的规则集可以在系统引导后由其他文件载入。对于一些设计的非常好的unix程序，PF提供了足够的灵活性。</p><p><strong>pf.conf文件有7个部分：</strong></p><ol><li>宏：用户定义的变量，包括IP地址，接口名称等等。</li><li>表：一种用来保存IP地址列表的结构。</li><li>选项：控制PF如何工作的变量。</li><li>整形：重新处理数据包，进行正常化和碎片整理。</li><li>排队：提供带宽控制和数据包优先级控制。</li><li>转换：控制网络地址转换和数据包重定向。</li><li>过滤规则：在数据包通过接口时允许进行选择性的过滤和阻止。</li></ol><p>除去宏和表，其他的段在配置文件中也应该按照这个顺序出现，尽管对于一些特定的应用并不是所有的段都是必须的。</p><p>空行会被忽略，以#开头的行被认为是注释。</p><h3 id="控制" tabindex="-1"><a class="header-anchor" href="#控制"><span>控制</span></a></h3><p>引导之后，PF可以通过pfctl程序进行操作，以下是一些例子：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>pfctl <span class="token parameter variable">-f</span> /etc/pf.conf  <span class="token comment"># 载入 pf.conf 文件</span>
pfctl <span class="token parameter variable">-nf</span> /etc/pf.conf <span class="token comment"># 解析文件，但不载入</span>
pfctl <span class="token parameter variable">-Nf</span> /etc/pf.conf <span class="token comment"># 只载入文件中的NAT规则</span>
pfctl <span class="token parameter variable">-Rf</span> /etc/pf.conf <span class="token comment"># 只载入文件中的过滤规则</span>
pfctl <span class="token parameter variable">-sn</span> <span class="token comment"># 显示当前的NAT规则</span>
pfctl <span class="token parameter variable">-sr</span> <span class="token comment"># 显示当前的过滤规则</span>
pfctl <span class="token parameter variable">-ss</span> <span class="token comment"># 显示当前的状态表</span>
pfctl <span class="token parameter variable">-si</span> <span class="token comment"># 显示过滤状态和计数</span>
pfctl <span class="token parameter variable">-sa</span> <span class="token comment"># 显示任何可显示的</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>完整的命令列表，请参阅pfctl的man手册页。</p>`,22),p=[l];function i(c,r){return a(),n("div",null,p)}const m=e(s,[["render",i],["__file","pfctl.html.vue"]]),f=JSON.parse('{"path":"/command/linux/pfctl.html","title":"pfctl","lang":"zh-CN","frontmatter":{"description":"pfctl PF防火墙的配置命令 补充说明 pfctl命令 是PF防火墙的配置命令，PF防火墙( 全称：Packet Filter )是UNIX LIKE系统上进行TCP/ip流量过滤和网络地址转换的软件系统。PF同样也能提供TCP/IP流量的整形和控制，并且提供带宽控制和数据包优先集控制。PF最早是由Daniel Hartmeier开发的，现在的开发...","head":[["meta",{"property":"og:url","content":"https://baymaxcoding.github.io/command/linux/pfctl.html"}],["meta",{"property":"og:site_name","content":"BaymaxCoding"}],["meta",{"property":"og:title","content":"pfctl"}],["meta",{"property":"og:description","content":"pfctl PF防火墙的配置命令 补充说明 pfctl命令 是PF防火墙的配置命令，PF防火墙( 全称：Packet Filter )是UNIX LIKE系统上进行TCP/ip流量过滤和网络地址转换的软件系统。PF同样也能提供TCP/IP流量的整形和控制，并且提供带宽控制和数据包优先集控制。PF最早是由Daniel Hartmeier开发的，现在的开发..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-12T04:24:50.000Z"}],["meta",{"property":"article:author","content":"BaymaxCoding"}],["meta",{"property":"article:modified_time","content":"2024-04-12T04:24:50.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"pfctl\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-04-12T04:24:50.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"BaymaxCoding\\",\\"url\\":\\"https://baymaxcoding.github.io/\\"}]}"]]},"headers":[{"level":2,"title":"补充说明","slug":"补充说明","link":"#补充说明","children":[{"level":3,"title":"激活","slug":"激活","link":"#激活","children":[]},{"level":3,"title":"配置","slug":"配置","link":"#配置","children":[]},{"level":3,"title":"控制","slug":"控制","link":"#控制","children":[]}]}],"git":{"createdTime":1712895890000,"updatedTime":1712895890000,"contributors":[{"name":"BaymaxCoding","email":"BRemail2324996822@163.com","commits":1}]},"readingTime":{"minutes":2.44,"words":732},"filePathRelative":"command/linux/pfctl.md","localizedDate":"2024年4月12日","autoDesc":true}');export{m as comp,f as data};
