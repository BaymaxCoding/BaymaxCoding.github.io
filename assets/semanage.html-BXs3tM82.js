import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as n,e}from"./app-D_HUMAmc.js";const t={},i=e(`<h1 id="semanage" tabindex="-1"><a class="header-anchor" href="#semanage"><span>semanage</span></a></h1><p>默认目录的安全上下文查询与修改</p><h2 id="补充说明" tabindex="-1"><a class="header-anchor" href="#补充说明"><span>补充说明</span></a></h2><p><strong>semanage命令</strong> 是用来查询与修改SELinux默认目录的安全上下文。SELinux的策略与规则管理相关命令：seinfo命令、sesearch命令、getsebool命令、setsebool命令、semanage命令。</p><h3 id="语法" tabindex="-1"><a class="header-anchor" href="#语法"><span>语法</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>semanage <span class="token punctuation">{</span>login<span class="token operator">|</span>user<span class="token operator">|</span>port<span class="token operator">|</span>interface<span class="token operator">|</span>fcontext<span class="token operator">|</span>translation<span class="token punctuation">}</span> <span class="token parameter variable">-l</span>
semanage fcontext -<span class="token punctuation">{</span>a<span class="token operator">|</span>d<span class="token operator">|</span>m<span class="token punctuation">}</span> <span class="token punctuation">[</span>-frst<span class="token punctuation">]</span> file_spec
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="选项" tabindex="-1"><a class="header-anchor" href="#选项"><span>选项</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>-l：查询。
fcontext：主要用在安全上下文方面。
-a：增加，你可以增加一些目录的默认安全上下文类型设置。
-m：修改。
-d：删除。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实例" tabindex="-1"><a class="header-anchor" href="#实例"><span>实例</span></a></h3><p>查询一下<code>/var/www/html</code>的默认安全性本文的设置：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>semanage fcontext <span class="token parameter variable">-l</span>
SELinux fcontext    <span class="token builtin class-name">type</span>          Context
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">(</span>前面省略<span class="token punctuation">)</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
/var/www<span class="token punctuation">(</span>/.*<span class="token punctuation">)</span>?      all files     system_u:object_r:httpd_sys_content_t:s0
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">(</span>後面省略<span class="token punctuation">)</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如上面例子所示，我们可以查询的到每个目录的安全性本文！而目录的设定可以使用正则表达式去指定一个范围。那么如果我们想要增加某些自定义目录的安全性本文呢？举例来说，我想要色设置<code>/srv/samba</code>成为 <code>public_content_t</code>的类型时，应该如何设置呢？</p><p>用semanage命令设置<code>/srv/samba</code>目录的默认安全性本文为<code>public_content_t</code>：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">mkdir</span> /srv/samba
ll <span class="token parameter variable">-Zd</span> /srv/samba
drwxr-xr-x  root root root:object_r:var_t    /srv/samba
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如上所示，默认的情况应该是<code>var_t</code>这个咚咚的！</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>semanage fcontext <span class="token parameter variable">-l</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&#39;/srv&#39;</span>
/srv/.*                     all files   system_u:object_r:var_t:s0
/srv/<span class="token punctuation">(</span><span class="token punctuation">[</span>^/<span class="token punctuation">]</span>*/<span class="token punctuation">)</span>?ftp<span class="token punctuation">(</span>/.*<span class="token punctuation">)</span>?     all files   system_u:object_r:public_content_t:s0
/srv/<span class="token punctuation">(</span><span class="token punctuation">[</span>^/<span class="token punctuation">]</span>*/<span class="token punctuation">)</span>?www<span class="token punctuation">(</span>/.*<span class="token punctuation">)</span>?     all files   system_u:object_r:httpd_sys_content_t:s0
/srv/<span class="token punctuation">(</span><span class="token punctuation">[</span>^/<span class="token punctuation">]</span>*/<span class="token punctuation">)</span>?rsync<span class="token punctuation">(</span>/.*<span class="token punctuation">)</span>?   all files   system_u:object_r:public_content_t:s0
/srv/gallery2<span class="token punctuation">(</span>/.*<span class="token punctuation">)</span>?         all files   system_u:object_r:httpd_sys_content_t:s0
/srv                        directory   system_u:object_r:var_t:s0   //看这里！
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面则是默认的<code>/srv</code>底下的安全性本文资料，不过，并没有指定到<code>/srv/samba</code>。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>semanage fcontext <span class="token parameter variable">-a</span> <span class="token parameter variable">-t</span> public_content_t <span class="token string">&quot;/srv/samba(/.*)?&quot;</span>
semanage fcontext <span class="token parameter variable">-l</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&#39;/srv/samba&#39;</span>
/srv/samba<span class="token punctuation">(</span>/.*<span class="token punctuation">)</span>?            all files   system_u:object_r:public_content_t:s0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">cat</span> /etc/selinux/targeted/contexts/files/file_contexts.local
<span class="token comment"># This file is auto-generated by libsemanage</span>
<span class="token comment"># Please use the semanage command to make changes</span>
/srv/samba<span class="token punctuation">(</span>/.*<span class="token punctuation">)</span>?    system_u:object_r:public_content_t:s0  <span class="token comment">#写入这个档案</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>restorecon <span class="token parameter variable">-Rv</span> /srv/samba* <span class="token comment">#尝试恢复默认值</span>
ll <span class="token parameter variable">-Zd</span> /srv/samba
drwxr-xr-x  root root system_u:object_r:public_content_t /srv/samba/  <span class="token comment">#有默认值，以后用restorecon命令来修改比较简单！</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>semanage命令的功能很多，这里主要用到的仅有fcontext这个选项的用法而已。如上所示，你可以使用semanage来查询所有的目录默认值，也能够使用它来增加默认值的设置！</p>`,21),o=[i];function c(l,p){return s(),n("div",null,o)}const u=a(t,[["render",c],["__file","semanage.html.vue"]]),m=JSON.parse('{"path":"/command/linux/semanage.html","title":"semanage","lang":"zh-CN","frontmatter":{"description":"semanage 默认目录的安全上下文查询与修改 补充说明 semanage命令 是用来查询与修改SELinux默认目录的安全上下文。SELinux的策略与规则管理相关命令：seinfo命令、sesearch命令、getsebool命令、setsebool命令、semanage命令。 语法 选项 实例 查询一下/var/www/html的默认安全性本文...","head":[["meta",{"property":"og:url","content":"https://baymaxcoding.github.io/command/linux/semanage.html"}],["meta",{"property":"og:site_name","content":"BaymaxCoding"}],["meta",{"property":"og:title","content":"semanage"}],["meta",{"property":"og:description","content":"semanage 默认目录的安全上下文查询与修改 补充说明 semanage命令 是用来查询与修改SELinux默认目录的安全上下文。SELinux的策略与规则管理相关命令：seinfo命令、sesearch命令、getsebool命令、setsebool命令、semanage命令。 语法 选项 实例 查询一下/var/www/html的默认安全性本文..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-12T04:24:50.000Z"}],["meta",{"property":"article:author","content":"BaymaxCoding"}],["meta",{"property":"article:modified_time","content":"2024-04-12T04:24:50.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"semanage\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-04-12T04:24:50.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"BaymaxCoding\\",\\"url\\":\\"https://baymaxcoding.github.io/\\"}]}"]]},"headers":[{"level":2,"title":"补充说明","slug":"补充说明","link":"#补充说明","children":[{"level":3,"title":"语法","slug":"语法","link":"#语法","children":[]},{"level":3,"title":"选项","slug":"选项","link":"#选项","children":[]},{"level":3,"title":"实例","slug":"实例","link":"#实例","children":[]}]}],"git":{"createdTime":1712895890000,"updatedTime":1712895890000,"contributors":[{"name":"BaymaxCoding","email":"BRemail2324996822@163.com","commits":1}]},"readingTime":{"minutes":1.92,"words":575},"filePathRelative":"command/linux/semanage.md","localizedDate":"2024年4月12日","autoDesc":true}');export{u as comp,m as data};
